2024-02-13T22:03:15.847473Z [error    ] Cannot start plugin tap-csv: Catalog discovery failed: command ['/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/bin/tap-csv', '--config', '/home/kirillov/code-challenge/.meltano/run/tap-csv/tap.8e9340a6-77a8-4ecd-97a5-feb7b0d04c4b.config.json', '--discover'] returned 1 with stderr:
 Could not append type because the JSON schema for the dictionary `{'oneOf': [{'type': ['number']}, {'type': ['string']}, {'type': ['boolean']}]}` appears to be invalid.
Could not append type because the JSON schema for the dictionary `{'oneOf': [{'type': ['string']}, {'type': 'array', 'items': {'type': ['string']}}]}` appears to be invalid.
2024-02-13 19:03:15,739 | WARNING  | tap-csv              | Config validation failed: {'files': ['data/order_values.csv'], 'settings': {'delimiter': ';', 'quotechar': '"', 'escapechar': '\\'}} is not of type 'string', 'null'
JSONSchema was: {'type': 'object', 'properties': {'files': {'type': ['array', 'null'], 'items': {'type': 'object', 'properties': {'entity': {'type': ['string']}, 'path': {'type': ['string']}, 'keys': {'type': 'array', 'items': {'type': ['string']}}, 'encoding': {'type': ['string', 'null'], 'default': 'utf-8'}, 'delimiter': {'type': ['string', 'null']}, 'doublequote': {'type': ['boolean', 'null']}, 'escapechar': {'type': ['string', 'null']}, 'quotechar': {'type': ['string', 'null']}, 'skipinitialspace': {'type': ['boolean', 'null']}, 'strict': {'type': ['boolean', 'null']}}, 'required': ['entity', 'path', 'keys']}, 'description': 'An array of csv file stream settings.'}, 'csv_files_definition': {'type': ['string', 'null'], 'description': 'A path to the JSON file holding an array of file settings.'}, 'add_metadata_columns': {'type': ['boolean', 'null'], 'default': False, 'description': 'When True, add the metadata columns (`_sdc_source_file`, `_sdc_source_file_mtime`, `_sdc_source_lineno`) to output.'}, 'stream_maps': {'type': ['object', 'null'], 'properties': {}, 'description': 'Config object for stream maps capability. For more information check out [Stream Maps](https://sdk.meltano.com/en/latest/stream_maps.html).'}, 'stream_map_config': {'type': ['object', 'null'], 'properties': {}, 'description': 'User-defined config values to be used within map expressions.'}, 'faker_config': {'type': ['object', 'null'], 'properties': {'seed': {'oneOf': [{'type': ['number']}, {'type': ['string']}, {'type': ['boolean']}], 'description': 'Value to seed the Faker generator for deterministic output: https://faker.readthedocs.io/en/master/#seeding-the-generator'}, 'locale': {'oneOf': [{'type': ['string']}, {'type': 'array', 'items': {'type': ['string']}}], 'description': 'One or more LCID locale strings to produce localized output for: https://faker.readthedocs.io/en/master/#localization'}}, 'description': 'Config for the [`Faker`](https://faker.readthedocs.io/en/master/) instance variable `fake` used within map expressions. Only applicable if the plugin specifies `faker` as an addtional dependency (through the `singer-sdk` `faker` extra or directly).'}, 'flattening_enabled': {'type': ['boolean', 'null'], 'description': "'True' to enable schema flattening and automatically expand nested properties."}, 'flattening_max_depth': {'type': ['integer', 'null'], 'description': 'The max depth to flatten schemas.'}}}
Traceback (most recent call last):
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/bin/tap-csv", line 8, in <module>
    sys.exit(TapCSV.cli())
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 1077, in main
    with self.make_context(prog_name, args, **extra) as ctx:
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 943, in make_context
    self.parse_args(ctx, args)
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 1408, in parse_args
    value, args = param.handle_parse_result(ctx, opts, args)
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 2400, in handle_parse_result
    value = self.process_value(ctx, value)
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 2362, in process_value
    value = self.callback(ctx, self, value)
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 541, in cb_discover
    tap.run_discovery()
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 296, in run_discovery
    catalog_text = self.catalog_json_text
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 316, in catalog_json_text
    return json.dumps(self.catalog_dict, indent=2)
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 307, in catalog_dict
    return t.cast(dict, self._singer_catalog.to_dict())
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 327, in _singer_catalog
    for stream in self.streams.values()
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 136, in streams
    for stream in self.load_streams():
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 360, in load_streams
    for stream in self.discover_streams():
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/tap_csv/tap.py", line 96, in discover_streams
    for file_config in self.get_file_configs()
  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/tap_csv/tap.py", line 77, in get_file_configs
    if os.path.isfile(csv_files_definition):
  File "/usr/lib/python3.8/genericpath.py", line 30, in isfile
    st = os.stat(path)
TypeError: stat: path should be string, bytes, os.PathLike or integer, not dict

2024-02-13T22:03:15.847845Z [error    ] Block run completed.           block_type=ExtractLoadBlocks err=RunnerError('Cannot start plugin tap-csv: Catalog discovery failed: command [\'/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/bin/tap-csv\', \'--config\', \'/home/kirillov/code-challenge/.meltano/run/tap-csv/tap.8e9340a6-77a8-4ecd-97a5-feb7b0d04c4b.config.json\', \'--discover\'] returned 1 with stderr:\n Could not append type because the JSON schema for the dictionary `{\'oneOf\': [{\'type\': [\'number\']}, {\'type\': [\'string\']}, {\'type\': [\'boolean\']}]}` appears to be invalid.\nCould not append type because the JSON schema for the dictionary `{\'oneOf\': [{\'type\': [\'string\']}, {\'type\': \'array\', \'items\': {\'type\': [\'string\']}}]}` appears to be invalid.\n2024-02-13 19:03:15,739 | WARNING  | tap-csv              | Config validation failed: {\'files\': [\'data/order_values.csv\'], \'settings\': {\'delimiter\': \';\', \'quotechar\': \'"\', \'escapechar\': \'\\\\\'}} is not of type \'string\', \'null\'\nJSONSchema was: {\'type\': \'object\', \'properties\': {\'files\': {\'type\': [\'array\', \'null\'], \'items\': {\'type\': \'object\', \'properties\': {\'entity\': {\'type\': [\'string\']}, \'path\': {\'type\': [\'string\']}, \'keys\': {\'type\': \'array\', \'items\': {\'type\': [\'string\']}}, \'encoding\': {\'type\': [\'string\', \'null\'], \'default\': \'utf-8\'}, \'delimiter\': {\'type\': [\'string\', \'null\']}, \'doublequote\': {\'type\': [\'boolean\', \'null\']}, \'escapechar\': {\'type\': [\'string\', \'null\']}, \'quotechar\': {\'type\': [\'string\', \'null\']}, \'skipinitialspace\': {\'type\': [\'boolean\', \'null\']}, \'strict\': {\'type\': [\'boolean\', \'null\']}}, \'required\': [\'entity\', \'path\', \'keys\']}, \'description\': \'An array of csv file stream settings.\'}, \'csv_files_definition\': {\'type\': [\'string\', \'null\'], \'description\': \'A path to the JSON file holding an array of file settings.\'}, \'add_metadata_columns\': {\'type\': [\'boolean\', \'null\'], \'default\': False, \'description\': \'When True, add the metadata columns (`_sdc_source_file`, `_sdc_source_file_mtime`, `_sdc_source_lineno`) to output.\'}, \'stream_maps\': {\'type\': [\'object\', \'null\'], \'properties\': {}, \'description\': \'Config object for stream maps capability. For more information check out [Stream Maps](https://sdk.meltano.com/en/latest/stream_maps.html).\'}, \'stream_map_config\': {\'type\': [\'object\', \'null\'], \'properties\': {}, \'description\': \'User-defined config values to be used within map expressions.\'}, \'faker_config\': {\'type\': [\'object\', \'null\'], \'properties\': {\'seed\': {\'oneOf\': [{\'type\': [\'number\']}, {\'type\': [\'string\']}, {\'type\': [\'boolean\']}], \'description\': \'Value to seed the Faker generator for deterministic output: https://faker.readthedocs.io/en/master/#seeding-the-generator\'}, \'locale\': {\'oneOf\': [{\'type\': [\'string\']}, {\'type\': \'array\', \'items\': {\'type\': [\'string\']}}], \'description\': \'One or more LCID locale strings to produce localized output for: https://faker.readthedocs.io/en/master/#localization\'}}, \'description\': \'Config for the [`Faker`](https://faker.readthedocs.io/en/master/) instance variable `fake` used within map expressions. Only applicable if the plugin specifies `faker` as an addtional dependency (through the `singer-sdk` `faker` extra or directly).\'}, \'flattening_enabled\': {\'type\': [\'boolean\', \'null\'], \'description\': "\'True\' to enable schema flattening and automatically expand nested properties."}, \'flattening_max_depth\': {\'type\': [\'integer\', \'null\'], \'description\': \'The max depth to flatten schemas.\'}}}\nTraceback (most recent call last):\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/bin/tap-csv", line 8, in <module>\n    sys.exit(TapCSV.cli())\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 1157, in __call__\n    return self.main(*args, **kwargs)\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 1077, in main\n    with self.make_context(prog_name, args, **extra) as ctx:\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 943, in make_context\n    self.parse_args(ctx, args)\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 1408, in parse_args\n    value, args = param.handle_parse_result(ctx, opts, args)\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 2400, in handle_parse_result\n    value = self.process_value(ctx, value)\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/click/core.py", line 2362, in process_value\n    value = self.callback(ctx, self, value)\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 541, in cb_discover\n    tap.run_discovery()\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 296, in run_discovery\n    catalog_text = self.catalog_json_text\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 316, in catalog_json_text\n    return json.dumps(self.catalog_dict, indent=2)\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 307, in catalog_dict\n    return t.cast(dict, self._singer_catalog.to_dict())\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 327, in _singer_catalog\n    for stream in self.streams.values()\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 136, in streams\n    for stream in self.load_streams():\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/singer_sdk/tap_base.py", line 360, in load_streams\n    for stream in self.discover_streams():\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/tap_csv/tap.py", line 96, in discover_streams\n    for file_config in self.get_file_configs()\n  File "/home/kirillov/code-challenge/.meltano/extractors/tap-csv/venv/lib/python3.8/site-packages/tap_csv/tap.py", line 77, in get_file_configs\n    if os.path.isfile(csv_files_definition):\n  File "/usr/lib/python3.8/genericpath.py", line 30, in isfile\n    st = os.stat(path)\nTypeError: stat: path should be string, bytes, os.PathLike or integer, not dict\n') exit_codes={} set_number=0 success=False
